sim.power <- function(t, errormodel = list(order = c(0, 0, 0), ar = 0, ma = 0), period = 0, k, 
                      b0 = 0, b1_step = 0, b2_covariate = 0, b2_mean = 0, b2_sd = 1, 
                      noise_sd = 0, b3_trend = 0, plot_data = FALSE, seed = NULL) {
  
  if (!require(TSA)) {
    install.packages("TSA", dependencies = TRUE)
    library(TSA)
  }
  
  # Set seed for reproducibility if provided
  if (!is.null(seed)) {
    set.seed(seed)
  }
  
  # Initialize vectors to store simulation results
  n.sims <- 1000  # Number of simulations
  signif <- rep(FALSE, n.sims)
  theta <- rep(NA, n.sims)
  pvalue <- rep(NA, n.sims)
  b2_estimates <- rep(NA, n.sims)
  time_coefficients <- rep(NA, n.sims)
  
  check_stationarity <- function(p, d, q) {
    #Check if the sum of p and q is within a range to avoid complex cases
    if (p < 0 || q < 0 || p > 3 || q > 3) {
      return(FALSE)  # Example constraint: p and q should be between 0 and 3
    }
    
    return(TRUE)
  }
  
